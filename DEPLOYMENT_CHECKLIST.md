# ✅ 部署检查清单

使用此清单确保部署流程顺利完成。

---

## 📋 部署前准备

### 代码准备
- [ ] 代码已提交到 Git
- [ ] 已创建 `.gitignore`，排除敏感文件
- [ ] 已推送到 GitHub/GitLab
- [ ] 已选择部署分支（通常是 `main` 或 `master`）

### API 和密钥
- [ ] 已获取 OpenAI API Key（或兼容服务）
- [ ] API Key 有足够余额
- [ ] 已测试 API Key 可用性
- [ ] 已准备好所有环境变量（参考 `ENV_VARIABLES.md`）

### 文件检查
- [ ] `Dockerfile` 存在且配置正确
- [ ] `requirements.txt` 包含所有依赖
- [ ] `memdemo/requirements.txt` 包含后端依赖
- [ ] `memdemo/frontend/package.json` 存在
- [ ] `.dockerignore` 已配置

---

## 🚀 部署流程

### 选择平台
- [ ] 已选择部署平台：
  - [ ] Zeabur（推荐，简单快速）
  - [ ] Railway（推荐，功能丰富）
  - [ ] Render（免费但有限制）
  - [ ] Docker（自己的服务器）
  - [ ] 其他：___________

### Zeabur 部署
- [ ] 已注册 Zeabur 账号
- [ ] 已连接 GitHub 账号
- [ ] 已创建新项目
- [ ] 已选择正确的仓库
- [ ] 已配置环境变量：
  - [ ] `OPENAI_API_KEY`
  - [ ] `OPENAI_API_BASE`
  - [ ] `LLM_MODEL`
  - [ ] `FLASK_ENV=production`
- [ ] 已触发部署
- [ ] 已等待构建完成（5-10 分钟）
- [ ] 已获取部署域名

### Railway 部署
- [ ] 已注册 Railway 账号
- [ ] 已创建新项目
- [ ] 已从 GitHub 部署
- [ ] Railway 检测到 `Dockerfile`
- [ ] 已配置环境变量（同上）
- [ ] 已配置持久化卷（可选）：
  - [ ] `/app/memdemo/data`
  - [ ] `/app/files`
- [ ] 已触发部署
- [ ] 已获取部署域名

### Docker 本地部署
- [ ] 已安装 Docker
- [ ] 已安装 Docker Compose
- [ ] 已创建 `.env` 文件
- [ ] 已运行 `docker-compose build`
- [ ] 已运行 `docker-compose up -d`
- [ ] 已检查容器状态：`docker ps`
- [ ] 已查看日志：`docker-compose logs -f`

---

## 🔍 部署后验证

### 健康检查
- [ ] 访问 `/api/health` 返回 200 状态
  ```bash
  curl https://your-domain.com/api/health
  ```
- [ ] 响应包含 `"status": "healthy"`

### 前端访问
- [ ] 可以打开主页
- [ ] 可以看到登录页面
- [ ] 页面样式正常加载
- [ ] 没有控制台错误（F12 检查）

### 后端功能
- [ ] 可以登录/创建用户
- [ ] 可以发送消息
- [ ] 可以接收 AI 回复
- [ ] SSE 流式响应正常工作
- [ ] 广告推荐显示正常

### 文件上传（如果需要）
- [ ] 可以上传图片
- [ ] 可以上传文档
- [ ] 可以上传视频
- [ ] 文件处理成功

### 记忆系统
- [ ] 短期记忆正常存储
- [ ] 中期记忆可以检索
- [ ] 长期记忆保存正确
- [ ] 跨会话记忆持久化

---

## ⚙️ 配置优化

### 性能配置
- [ ] 已配置适当的 workers 数量
- [ ] 已设置合理的超时时间
- [ ] 已启用 Gzip 压缩（可选）
- [ ] 已配置 CDN（可选）

### 安全配置
- [ ] HTTPS 已启用
- [ ] 环境变量已加密存储
- [ ] 已设置速率限制（可选）
- [ ] 已配置 CORS 策略

### 监控配置
- [ ] 已配置日志记录
- [ ] 已设置错误监控（可选）
- [ ] 已配置性能监控（可选）
- [ ] 已设置告警通知（可选）

---

## 💾 数据持久化

### 文件存储
- [ ] 已配置持久化卷（云平台）
- [ ] 已挂载数据目录（Docker）
- [ ] 已测试数据重启后保留

### 备份策略
- [ ] 已计划定期备份用户数据
- [ ] 已测试备份恢复流程
- [ ] 已配置自动备份（可选）

---

## 📈 成本管理

### 免费额度跟踪
- [ ] 已了解平台免费额度限制
- [ ] 已设置用量告警
- [ ] 已配置成本监控

### API 使用
- [ ] 已了解 LLM API 计费方式
- [ ] 已设置 API 用量限制
- [ ] 已监控 API 消费

---

## 📝 文档和维护

### 文档记录
- [ ] 已记录部署配置
- [ ] 已记录环境变量
- [ ] 已记录自定义修改
- [ ] 已更新 README

### 维护计划
- [ ] 已计划定期更新依赖
- [ ] 已设置安全补丁流程
- [ ] 已配置自动部署（可选）

---

## 🐛 故障排查

如果遇到问题，检查：

### 部署失败
- [ ] 查看构建日志
- [ ] 检查 Dockerfile 语法
- [ ] 验证依赖版本兼容性
- [ ] 确认环境变量正确

### 运行时错误
- [ ] 查看应用日志
- [ ] 检查 API Key 是否正确
- [ ] 验证内存是否足够
- [ ] 检查网络连接

### 性能问题
- [ ] 检查内存使用
- [ ] 查看 CPU 使用率
- [ ] 分析响应时间
- [ ] 优化模型大小

---

## 📞 获取帮助

如果遇到无法解决的问题：

- [ ] 查阅 `DEPLOYMENT.md` 详细文档
- [ ] 查看 `ENV_VARIABLES.md` 配置说明
- [ ] 阅读 `OPTIMIZATION.md` 优化建议
- [ ] 搜索 GitHub Issues
- [ ] 提交新 Issue（使用 deployment-issue 模板）

---

## 🎉 部署成功

恭喜！如果以上所有关键步骤都已完成，你的应用应该已经成功部署。

### 下一步
- [ ] 分享应用链接
- [ ] 邀请测试用户
- [ ] 收集反馈
- [ ] 持续优化

### 可选增强
- [ ] 配置自定义域名
- [ ] 添加分析跟踪
- [ ] 集成第三方服务
- [ ] 扩展功能

---

**记住：部署是迭代过程，不断改进！**

---

## 📅 维护日程

建议的维护计划：

| 频率 | 任务 |
|------|------|
| 每天 | 检查应用健康状态 |
| 每周 | 查看日志和错误报告 |
| 每月 | 更新依赖和安全补丁 |
| 每季度 | 性能优化和成本审查 |
| 每年 | 重大版本升级 |

---

*最后更新：2024-01-23*

